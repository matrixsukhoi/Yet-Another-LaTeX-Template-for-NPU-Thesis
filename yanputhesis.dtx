% \iffalse meta-comment
% !TeX program  = XeLaTeX
% !TeX encoding = UTF-8
%
% Copyright (C) 2022 by Shangkun Shen
% -----------------------------------
%
% This file may be distributed and/or modified under the
% conditions of the LaTeX Project Public License, either version 1.3
% of this license or (at your option) any later version.
% The latest version of this license is in:
%
%    http://www.latex-project.org/lppl.txt
%
% and version 1.3 or later is part of all distributions of LaTeX
% version 2005/12/01 or later.
%
%<*internal>
\iffalse
%</internal>
%<*internal>
\fi
\def\nameofplainTeX{plain}
\ifx\fmtname\nameofplainTeX\else
  \expandafter\begingroup
\fi
%</internal>
%<*install>
\input docstrip.tex
\keepsilent
\askforoverwritefalse
\preamble
Copyright (C) 2022 by Shangkun Shen

It may be distributed and/or modified under the conditions of the LaTeX
Project Public License, either version 1.3b of this license or (at your
option) any later version. The latest version of this license is in
    https://www.latex-project.org/lppl.txt
and version 1.3b or later is part of all distributions of LaTeX version
2005/12/01 or later.
\endpreamble
\postamble

This work consists of the file  yanputhesis.dtx
and the derived files           yanputhesis.ins,
                                yanputhesis.pdf,
                                yanputhesis.cls.

\endpostamble

\generate
{
  \usedir{tex/latex/yanputhesis}
  \file{yanputhesis.cls}             {\from{\jobname.dtx}{class}}
%</install>
%<*internal>
  \usedir{source/latex/yanputhesis}
  \file{\jobname.ins}              {\from{\jobname.dtx}{install}}
%</internal>
%<*install>
   \usedir{doc/latex/yanputhesis}
   \file{yanputhesis-sample.tex}      {\from{\jobname.dtx}{sample}}
}

\Msg{*************************************************************}
\Msg{*                                                           *}
\Msg{* To finish the installation you have to move the following *}
\Msg{* files into a directory searched by TeX:                   *}
\Msg{*                                                           *}
\Msg{* \space\space yanputhesis.cls                              *}
\Msg{*                                                           *}
\Msg{* To produce the documentation run the files ending with    *}
\Msg{* `.dtx' through XeLaTeX.                                   *}
\Msg{*                                                           *}
\Msg{* Happy TeXing                                              *}
\Msg{*************************************************************}

%</install>
%<install>\endbatchfile
%<*internal>
\ifx\fmtname\nameofplainTeX
  \expandafter\endbatchfile
\else
  \expandafter\endgroup
\fi
%</internal>
%<*driver>
\ProvidesFile{yanputhesis.dtx}
%</driver>
%<class>\NeedsTeXFormat{LaTeX2e}[2005/12/01]
%<class>\ProvidesClass{yanputhesis}
%<*class>
    [2022/11/01 v1.7.1 Yet Another NPU Thesis Template]
%</class>
%
%<*driver>
\documentclass{ctxdoc}
\EnableCrossrefs
\CodelineIndex
\RecordChanges
\newcommand{\markdtxchanges}[3]{{\scriptsize{\qquad\%{#1}({#2})：{#3}}}\changes{#1}{#2}{#3}}
\begin{document}
    \DocInput{yanputhesis.dtx}
    \IndexLayout
    \PrintChanges
    \PrintIndex
\end{document}
%</driver>
% \fi
% \changes{v1.7.0b}{2022/11/29}{update to latest format}
% \changes{v1.7.0}{2022/10/31}{Major version, update the format}
% \changes{v1.6.0}{2022/02/18}{Major version, package into cls file}
% \changes{v1.5.0}{2020/04/28}{Major version, for Bachelors, Masters, and PhDs}
% \changes{v1.4.0}{2018/03/15}{Update the format and the example file}
% \changes{v1.3.0}{2017/05/16}{Update the format}
% \changes{v1.2.0}{2017/05/06}{Update the format}
% \changes{v1.1.0}{2016/06/06}{Update the format}
% \changes{v1.0.0}{2016/05/18}{Initial version, for Bachelors dissertation only}
%
% \GetFileInfo{yanputhesis.dtx}
%
% \DoNotIndex{\newcommand,\newenvironment}
%
%^^A---------------------------------------------------------------------------%
% \title{The \textsf{yanputhesis} class\thanks{This document
%   corresponds to \textsf{yanputhesis}~\fileversion, dated \filedate.}}
% \author{Shangkun Shen \\ \texttt{polossk\_dev@126.com}}
%
% \maketitle
% \tableofcontents
%^^A---------------------------------------------------------------------------%
% \begin{abstract}
% 这是在西北工业大学本科毕业设计、硕博研究生毕业论文格式的要求下的一份 LaTeX 文
% 档类模板. 使用者无需额外修改格式控制细节, 直接在所发布的样例基础上, 修改章节标
% 题, 撰写内容, 即可完成毕业设计论文任务.
% \end{abstract}
%
%^^A---------------------------------------------------------------------------%
% \section{简介}
%
% 本模板主要参考开源库 polossk/LaTeX-Template-For-NPU-Thesis 和 NPUSCG/nputhesis
% , 并在此基础上之上修改而成, 格式参照于 2014 年西北工业大学研究生院编写的西北工
% 业大学博士研究生学位论文编写规则（试用版）.
%
% 项目名称 yanputhesis 是 Yet Another NPU Thesis 的缩写, 即另一个西北工业大学毕
% 业设计论文模板.
%
% 本模板的实现参考了目前仍在维护的模板, 这些模板的贡献者有（按姓氏排序）:
% \begin{itemize}
%     \item 西工大玄学办: Shangkun Shen(@polossk), Zhihe Wang(@cfrpg), Jiduo
% Zhang(@kidozh), Weijia Zhang(@njzwj)
%     \item GitHub: Yiqiang Li(@lyq105), @likunyao, Wei Wang(@WilmerWang),
% Zongze Yang(@lrtfm)
% \end{itemize}
%
%^^A---------------------------------------------------------------------------%
% \section{使用说明}
%
%    \begin{macrocode}
%<*sample>
%%=============================================================================%
%% 设置论文格式（学位、盲评、Adobe 字体）
%%-----------------------------------------------------------------------------%
\documentclass[lang=chs, degree=phd, blindreview=false, adobe=false]{yanputhesis}
%%=============================================================================%
%% 导言区：请自行添加额外宏包
%%-----------------------------------------------------------------------------%
\usepackage{blindtext}                                      % 生成无意义文本
\usepackage{metalogo}                                       % 软件标志
\usepackage[binary-units=true]{siunitx}                     % 物理量单位
\usepackage{amsmath}                                        % 基础数学库
%%=============================================================================%
%% 参考文献（也可以是独立文件）
%%-----------------------------------------------------------------------------%
\begin{filecontents}{reference.bib}
@software{NWPUThesisLaTeXTemplate,
  title     = {Yet Another {{\LaTeX}} Template for NPU Thesis},
  author    = {Shangkun Shen and Zhihe Wang and Jiduo Zhang and Weijia Zhang},
  month     = {11},
  year      = {2019},
  publisher = {Zenodo},
  journal   = {GitHub repository},
  doi       = {10.5281/zenodo.4159248},
  url       = {https://doi.org/10.5281/zenodo.4159248}
}

@book{knuth1986the,
  title     = {The {{\TeX}}book},
  author    = {Knuth, Donald E},
  publisher = {Addison-Wesley},
  year      = {1986}
}

@book{lamport1989latex,
  title     = {{{\LaTeX}}: a document preparation system},
  author    = {Lamport, Leslie},
  publisher = {Addison-Wesley Professional},
  year      = {1989}
}

@article{szegedy2015going,
  title   = {Going deeper with convolutions},
  author  = {Szegedy, Christian and Liu, Wei and Jia, Yangqing and
             Sermanet, Pierre and Reed, Scott E and Anguelov, Dragomir and
             Erhan, Dumitru and Vanhoucke, Vincent and Rabinovich, Andrew},
  journal = {Computer Vision and Pattern Recognition},
  pages   = {1--9},
  year    = {2015}
}

@software{MathSymbolsinLaTeXbypolossk,
  title     = {Math Symbols in {{\LaTeX}}},
  author    = {Shangkun Shen},
  year      = {2017},
  month     = {10},
  publisher = {Zenodo},
  journal   = {GitHub repository},
  doi       = {10.5281/zenodo.4120375},
  url       = {https://doi.org/10.5281/zenodo.4120375}
}

@article{chen2014maiyuan,
  title   = {脉源三支 强强融合——西北工业大学},
  author  = {{陈家忠}},
  journal = {电子技术与软件工程},
  number  = {9},
  pages   = {15--16},
  year    = {2014}
}

@article{shen2021peridynamic,
  title     = {Peridynamic modeling with energy-based surface correction for
               fracture simulation of random porous materials},
  journal   = {Theoretical and Applied Fracture Mechanics},
  volume    = {114},
  pages     = {102987},
  year      = {2021},
  issn      = {0167-8442},
  author    = {Shangkun Shen and Zihao Yang and Fei Han and Junzhi Cui and
               Jieqiong Zhang},
  publisher = {Elsevier}
}
\end{filecontents}
%%=============================================================================%
%% 基本信息录入
%%-----------------------------------------------------------------------------%
\title{基于 LaTeX 排版的 \\ 西北工业大学论文模板}{          % 中英文标题
    Yet Another Thesis Template of \\ Northwestern Polytechnical University
}                                                           % 请自行断行
\author{XXX}{Yilong Ma}                              % 姓名
\date{2023年6月}{Jun 2023}                                  % 答辩日期
\school{计算机学院}{School of Computer Science}% 学院
\major{计算机科学}{Computer Science}                     % 专业 博士请添加 Ph
\advisor{朱怡安}{Yian Zhu}                                  % 导师
\advisoralign{朱\ 怡\ 安}{Yian Zhu}
\studentnumber{2018114514}                                  % 学号
\funding{本研究得到玄学基金（编号23336666）资助．}{         % 基金资助
    The present work is supported by Funding of Metaphysics %
    (Project No：23336666).}                                %                         %
%%=============================================================================%
%% 文档开始
%%-----------------------------------------------------------------------------%
\begin{document}
%%-----------------------------------------------------------------------------%
%% 总前言，包含封皮页、中英文标题、中英文摘要、目录
%%-----------------------------------------------------------------------------%
\frontmatter                                                % 前言部分
\maketitle                                                  % 封皮页及标题页
%%-----------------------------------------------------------------------------%
\begin{abstract}                                            % 中文摘要开始
    这是在西北工业大学本科毕业设计、硕博研究生毕业论文格式的要求下的一份 LaTeX
    文档类模板．使用者无需额外修改格式控制细节，直接在所发布的样例基础上，修改章
    节标题，撰写内容，即可完成毕业设计论文任务．            %
    \begin{keywords}                                        % 中文关键词开始
        学位论文，模板，\LaTeX                              %
    \end{keywords}                                          % 中文关键词结束
\end{abstract}                                              % 中文摘要结束
%%-----------------------------------------------------------------------------%
\begin{engabstract}                                         % 英文摘要开始
    \noindent \blindtext                                    %
    \begin{engkeywords}                                     % 英文关键词开始
        thesis, template, \LaTeX                            %
    \end{engkeywords}                                       % 英文关键词结束
\end{engabstract}                                           % 英文摘要结束
%%-----------------------------------------------------------------------------%
\tableofcontents                                            % 目录
\listoffigures                                              % 图目录（学校未做要求）
\listoftables                                               % 表目录（学校未做要求）
\printnomenclature                                          % 符号表（学校未做要求）
%%-----------------------------------------------------------------------------%
\mainmatter
\sDefault
\chapter{绪论}
\chaptermark{绪论}
\section{这是中标题}
emmmm
\subsection{这是小标题}
emmmmm
\subsubsection{这是小小标题}
搞这么多层大丈夫?

\section{公式}
简单行内公式 $a+b=233$，超高公式会被压缩 $\frac{1}{2}=0.5$ 或者使用
\lstinline`\displaystyle` 防止被压缩：$\displaystyle \frac{1}{2}=0.5$．

简单的不标号单行公式
$$a_0+a_1+a_2=\sqrt{233}$$
需要标号和起名的公式如\autoref{eq:eqtest} 所示．测试下 autoref \autoref{eq:eqtest}
\begin{equation}
    \label{eq:eqtest}
    a_0 + a_1 + a_2 = \sqrt{233}
\end{equation}

\section{特殊符号}

用\href{http://detexify.kirelabs.org/classify.html}{
    http://detexify.kirelabs.org/classify.html}画出来．

\section{参考文献的引用}

\LaTeX{} 中要求参考文献使用 \lstinline`\cite` 进行参考引用，若论文要求中说明需在
文字的右上角注明引用，请使用命令 \lstinline`\cite` 进行参考引用．举个
不恰当的例子，比如本论文模板的原版
`LaTeX-Template-For-NPU-Thesis'\cite{NWPUThesisLaTeXTemplate} 要求务必声明引用,
同时预配置了插件 `math-symbols' \cite{MathSymbolsinLaTeXbypolossk}．对组件的引
用是每一名科学工作者的基本素养（一本正经）．对于需要引用但是并不需要明确指明引用
位置的文献，请使用 \lstinline`\nocite` 命令．

在此同时感谢真正的 dalao 高德纳开发了全世界版本号最接近 $\pi$ 的软件
\LaTeX \cite{knuth1986the}\nocite{lamport1989latex}．

测试引用文献 \cite{szegedy2015going, shen2021peridynamic, chen2014maiyuan}．其中
最后一篇为中文文献．

\section{标点符号的选择}

根据《中华人民共和国国家标准 GB/T 15834-1995》及《出版工作中的语言文字规范》中提
及，“科学技术中文图书，如果涉及公式、算式较多，句号可以统一用英文句号‘．’，省略
号用英文三个点的省略号‘…’”．如果您是中文的科技论文写作者，建议您使用全角英文句
号“\lstinline`．`”间隔句子．如果是人文学科则可以不做处理．您也可以在一开始先使用
中文句号‘。’，最后批量替换即可．

\section{萌新如何编译}

\begin{enumerate}
    \setlength{\itemsep}{0pt}
    \item 安装正确版本的 TexLive 2021
    \item 使用自带的 TeXworks 打开 \lstinline`yanputhesis-sample.tex`
    \item 左上角下拉框选择工具
    \item 依次使用 \lstinline`XeLaTeX-BibTeX-XeLaTeX-XeLaTeX` 编译
\end{enumerate}

\cleardoublepage

\chapter{插入图表以及如何引用}
\chaptermark{插入图表以及如何引用}

\section{表格}

使用 \href{http://www.tablesgenerator.com/}{http://www.tablesgenerator.com/} 生
成, 可粘贴Excel．效果如表\ref{my-label}所示．注意表中的字号（五号）和表格宽度（
通栏）．外部请用 \lstinline`table` 环境, 内部使用 \lstinline`tabularx` 即可．

\begin{table}[!h]
    \centering
    \caption{表格标题}
    \label{my-label}
    \begin{tabularx}{\textwidth}{CCCC}
        \toprule
        $A$ & $B$ & $A+B$ & $A\times B$ \\ \midrule
        1   & 6   & 7     & 6           \\
        2   & 7   & 9     & 14          \\
        3   & 8   & 11    & 24          \\
        4   & 9   & 13    & 36          \\
        5   & 10  & 15    & 50          \\ \bottomrule
    \end{tabularx}
\end{table}

\begin{table}[!h]
    \centering
    \caption{指定宽度与对齐方式}
    \label{my-label-2}
    \begin{tabularx}{\textwidth}{|P{2cm}|O{3cm}|Q{4cm}|C}
        \toprule
        \SI{2}{\centi\metre} & \SI{3}{\centi\metre} & \SI{4}{\centi\metre} & Other \\ \midrule
        1                    & 6                    & 7                    & 1     \\
        2                    & 7                    & 9                    & 2     \\
        3                    & 8                    & 11                   & 3     \\ \bottomrule
    \end{tabularx}
\end{table}

\section{插图}

请直接使用 \lstinline`figure` 环境，内部使用 \lstinline`includegraphics` 即可．
如果需要多张子图排版，请在 \lstinline`figure` 环境内部使用 \lstinline`minipage`
预先设置总的浮动体宽度，然后再使用 \lstinline`subfigure` 环境进行排版．

测试下文章内的图片引用．如\autoref{fig:example} 和\autoref{fig:example2} 所示，
这是两幅插图．在这其中\autoref{subfig:example2-subfig1} 是第一幅子图，
\autoref{subfig:example2-subfig2} 是第二幅子图．

\begin{figure}[htb]
    \centering
    \includegraphics[scale=0.2]{poster.png}
    \caption{
        这里是个普通的标题
    }
    \label{fig:example}
\end{figure}

\begin{figure}[htb]
    \centering
    \begin{minipage}[t]{0.96\textwidth}
        \centering
        \begin{subfigure}[t]{0.47\textwidth}
            \centering
            \includegraphics[scale=0.1]{poster.png}
            \caption{\label{subfig:example2-subfig1}}
        \end{subfigure}
        \begin{subfigure}[t]{0.47\textwidth}
            \centering
            \includegraphics[scale=0.1]{poster.png}
            \caption{\label{subfig:example2-subfig2}}
        \end{subfigure}
    \end{minipage}
    \caption{这里是另一个普通的标题}
    \label{fig:example2}
\end{figure}

\section{插入源代码}

这里给出一个 Hello World 的样例，如\autoref{code:hello-world} 所示．

\begin{lstlisting}[language={C++}, label={code:hello-world},
    caption={Hello\_World.cpp}]
#include <iostream>
using namespace std;

int main()
{
    // output "Hello World!"
    cout << "Hello World!" << endl;
    return 0;
}
\end{lstlisting}

\section{引用以及其他编写建议}

\LaTeX 提供了 \lstinline`ref` 和 \lstinline`autoref` 两种引用方式，其中前者只显
示序号，后者可以显示提示语，如“\autoref{code:hello-world}”表示引用代码，
而“\autoref{subfig:example2-subfig2}”表示引用图片的子图.为了方便引用以及作者阅读，
本人强烈建议使用 \lstinline`autoref` 来统一处理引用问题，同时在每一个
\lstinline`autoref` 添加提示语，如 \lstinline`fig` 和 \lstinline`tab` 分别表示插
图和表格．

由于 \XeLaTeX 在处理中文时，会自动在中文之间添加空格，所以请放心地在编写文档时换
行，防止某一行过长导致阅读时的不便．另外中英文之间的空格（包括命令）并未做严格限
制．本文推荐除在不影响最终成文的结果这一前提下，为保持文档的美观与易读，请自行选
择合适的编写方式．

\cleardoublepage
%%=============================================================================%
%% 参考文献以及附录
%%-----------------------------------------------------------------------------%
\bibliographystyle{nputhesis}                               % 参考文献格式
\bibliography{reference}                                    % 参考文献
\appendix
\chapter{一份说明}

\section{测试附录子标题}

这是一份附录，请放置一些独立的证明、源代码、或其他辅助资料．

\nomenclature{$r$}{圆（或球）的半径}
\nomenclature{$C$}{圆的周长}
\nomenclature{$S$}{圆的面积}

\begin{equation}
    C = 2 \pi r
\end{equation}

\begin{equation}
    S = \pi r^2
\end{equation}

\cleardoublepage

\chapter{另一份说明}

这是另一份附录，请放置一些独立的证明、源代码、或其他辅助资料．

\nomenclature{$S_{\text{sphere}}$}{球的表面积}
\nomenclature{$V_{\text{sphere}}$}{球的体积}

\begin{equation}
    S_{\text{sphere}} = 4 \pi r^2
\end{equation}

\begin{equation}
    V_{\text{sphere}} = \frac43 \pi r^3
\end{equation}

\cleardoublepage
%%=============================================================================%
%% 文档附页部分（致谢、参加科研情况、知识产权与原创性声明）
%%-----------------------------------------------------------------------------%
\backmatter                                                 % 文档附页部分
%%-----------------------------------------------------------------------------%
\begin{acknowledgements}                                    % 致谢开始
    感谢我的老师和我的朋友们……
\end{acknowledgements}                                      % 致谢结束
%%-----------------------------------------------------------------------------%
\begin{accomplishments}                                     % 参加科研情况开始
    [1] ...
\end{accomplishments}                                       % 参加科研情况结束
%%-----------------------------------------------------------------------------%
\makestatement                                              % 知识产权与原创性声明
%%=============================================================================%
%% 文档结束
%%-----------------------------------------------------------------------------%
\end{document}
%%=============================================================================%
%</sample>
%    \end{macrocode}
%
%^^A---------------------------------------------------------------------------%
% \section{安装说明}
%
% \begin{itemize}
%     \item 本模板提供了 make 工具用于辅助生成 cls 文档类及样例．
%     \item 命令行内输入 |make && make samplebib| 一次性生成所需文件．
%     \item 命令行内输入 |make sample| 生成不带参考文献的样例．
%     \item 命令行内输入 |make samplebib| 生成带有参考文献的样例．
% \end{itemize}
%
%^^A---------------------------------------------------------------------------%
% \section{代码实现}
%
%^^A---------------------------------------------------------------------------%
% \subsection{文档选项和基础文档类型控制}
%
% \begin{itemize}
%     \item 本模板基于 book 类实现, 通过选项来控制生成版本的类型．
%     \item 本模板使用 |xkeyval| 辅助控制文档选项．新建布尔变量用于标记文档类型
%     为本科、硕士、或博士版本．针对不同的模板类型, 将对应的标记置为真值 |true|,
%     其余为假值 |false|．
%     \item 声明选项 lang, 可选参数为 |chs|, |eng|, 分别对应中英文论文模板．
%     \item 声明选项 degree, 可选参数为 |phd|,  |master|, |bachelor|, 分别对应博
%     士、硕士、和本科毕业设计论文．
%     \item 声明选项 blindreview, 用于生成盲评版本, 并储存在对应的布尔变量上．
%     \item 声明选项 adobe, 用于指定模板使用 Adobe 中文字体生成（需自行准备宋体、
%     黑体、楷体、仿宋字体文件）．
%     \item 本模板默认选项为中文博士非盲评版本, 且不使用 Adobe 中文字体．
% \end{itemize}
%
%    \begin{macrocode}
%<*class>
%%=============================================================================%
%% 文档选项和基础文档类型控制
%%-----------------------------------------------------------------------------%
\RequirePackage{xkeyval}
\newif\if@npu@lang@chs                                      % 中文版本标记
\newif\if@npu@type@phd                                      % 博士版本标记
\newif\if@npu@type@mst                                      % 硕士版本标记
\newif\if@npu@type@bcl                                      % 本科版本标记
\newif\if@npu@output@blindreview                            % 盲评版本标记
\newif\if@npu@font@adobe                                    % Adobe 字体标记
\def\set@lang@chs{\@npu@lang@chstrue}                       % 设置中文版本
\def\set@lang@eng{\@npu@lang@chsfalse}                      % 设置英文版本
\def\set@type@phd{     \@npu@type@phdtrue\@npu@type@mstfalse\@npu@type@bclfalse}
\def\set@type@master{  \@npu@type@phdfalse\@npu@type@msttrue\@npu@type@bclfalse}
\def\set@type@bachelor{\@npu@type@phdfalse\@npu@type@mstfalse\@npu@type@bcltrue}
\DeclareOptionX{lang}[chs]{\csname set@lang@#1\endcsname}
\DeclareOptionX{degree}[phd]{\csname set@type@#1\endcsname}
\DeclareOptionX{blindreview}[true]{\csname @npu@output@blindreview#1\endcsname}
\DeclareOptionX{adobe}[true]{\csname @npu@font@adobe#1\endcsname}
\DeclareOptionX*{\PassOptionsToClass{\CurrentOption}{book}} % 传递参数到 book 类
\ExecuteOptionsX{lang=chs}                                  % 默认为中文版本
\ExecuteOptionsX{degree=phd}                                % 默认为博士版本
\ExecuteOptionsX{blindreview=false}                         % 默认不开启盲评模式
\ExecuteOptionsX{adobe=false}                               % 默认不用 Adobe 字体
\ProcessOptionsX \relax                                     %
\LoadClass[11pt, a4paper, openany, twoside]{book}           % 默认双面印刷
%%=============================================================================%
%    \end{macrocode}
%
%^^A---------------------------------------------------------------------------%
% \subsection{格式控制及组件控制}
%
% \begin{itemize}
%     \item 使用 |geometry| 来控制纸张尺寸以及页边距大小．
%     \item 使用 |hyperref| 添加书签超链接，并设置通过 Acrobat 打开的默认选项．
%     \item 使用 |type1cm| 控制字号与行距，统一前缀 s (size)．
%     \item 使用 |ifplatform| 控制不同平台下的字体．
%     \item 使用 |fontspec| 以及 |xeCJK| 控制中英文字体，统一前缀 f (font),
%           并且设置中文段落及换行风格．
%     \item 使用 |indentfirst| 添加段首空格控制．
%     \item 使用 |ulem| 添加下划线控制．
%     \item 使用 |layouts| 添加页面具体尺寸信息．
%     \item 使用 |titlesec| 和 |titletoc| 添加目录及标题控制．
%     \item 使用 |fancyhdr| 和 |fancyref| 添加页眉及页脚控制．
%     \item 使用 |natbib| 添加引用参考文献功能，并且设置中文上标引用格式．
%     \item 使用 |enumerate| 和 |enumitem| 添加插入列表功能．
%     \item 添加插入图表和整页 PDF 文件功能，并使用 |caption| 控制排版格式．
%     \item 使用 |ntheorem| 添加插入定理环境功能．
%     \item 使用 |listings| 添加插入源代码功能．
%     \item 使用 |algorithm| 和 |fancyref| 添加算法流程或伪代码功能．
%     \item 使用 |appendix| 添加插入附录功能．
%     \item 使用 |nomencl| 和 |multicol| 添加分栏符号表功能．
% \end{itemize}
%
%    \begin{macrocode}
%%=============================================================================%
%% 格式控制及组件控制
%%-----------------------------------------------------------------------------%
\RequirePackage{geometry}                                   % 纸张尺寸及页边距
\geometry{a4paper,                                          % A4 纸张
    left=2.5cm, right=2.5cm, top=2.54cm, bottom=3.0cm}     % 页边距
%%-----------------------------------------------------------------------------%
\RequirePackage[                                            % 超链接设置
    unicode=true,                                           % 允许 Unicode
    colorlinks=false,                                       % 不改变文字颜色
    pdfborder={0 0 0}]{hyperref}                            % 不显示边框
\hypersetup{                                                % Acrobat 默认设置
    bookmarks=true,                                         % 显示书签页
    pdftoolbar=true,                                        % 显示工具栏
    pdfmenubar=true,                                        % 显示菜单栏
    pdffitwindow=true,                                      % 缩放以适应窗口大小
    pdfstartview={FitH},                                    % 适合窗口宽度
    pdfnewwindow=true,                                      % 以新窗口打开链接
}                                                           %
%%-----------------------------------------------------------------------------%
\RequirePackage{type1cm}                                    % 设置字号与行距
\newcommand{\sChuhao}{\fontsize{42pt}{63pt}\selectfont}     % 初号, 1.5 倍
\newcommand{\sYihao}{\fontsize{26pt}{36pt}\selectfont}      % 一号, 1.4 倍
\newcommand{\sErhao}{\fontsize{22pt}{28pt}\selectfont}      % 二号, 1.25 倍
\newcommand{\sXiaoer}{\fontsize{18pt}{18pt}\selectfont}     % 小二, 单倍
\newcommand{\sSanhao}{\fontsize{16pt}{24pt}\selectfont}     % 三号, 1.5 倍
\newcommand{\sXiaosan}{\fontsize{15pt}{22pt}\selectfont}    % 小三, 1.5 倍
\newcommand{\sSihao}{\fontsize{14pt}{21pt}\selectfont}      % 四号, 1.5 倍
\newcommand{\sHgXiaosi}{\fontsize{13pt}{19pt}\selectfont}   % 半小四, 1.5 倍
\newcommand{\sLgXiaosi}{\fontsize{12.5pt}{13pt}\selectfont} % 半小四, 约 1 倍
\newcommand{\sXiaosi}{\fontsize{12pt}{14.4pt}\selectfont}   % 小四, 1.2 倍
\newcommand{\sLargeWuhao}{\fontsize{11pt}{11pt}\selectfont} % 大五, 单倍
\newcommand{\sWuhao}{\fontsize{10.5pt}{10.5pt}\selectfont}  % 五号, 单倍
\newcommand{\sXiaowu}{\fontsize{9pt}{9pt}\selectfont}       % 小五, 单倍
\newcommand{\sDefault}{\fontsize{12pt}{20pt}\selectfont}    % 小四, 1.67 倍
%%-----------------------------------------------------------------------------%
\RequirePackage{ifplatform}                                 % 跨平台字体控制依赖
\if@npu@font@adobe                                          % 检测 Adobe 选项
    \newcommand\defaultSog{Adobe Song Std}                  % 宋体, 用于正文
    \newcommand\defaultHei{Adobe Heiti Std}                 % 黑体, 用于标题
    \newcommand\defaultKai{Adobe Kaiti Std}                 % 楷体, 一般用于强调
    \newcommand\defaultFag{Adobe Fangsong Std}              % 仿宋, 一般用于强调
\else                                                       % 使用系统自带字体
    \ifwindows                                              % Windows 环境
        \newcommand\defaultSog{SimSun}                      % 宋体, 用于正文
        \newcommand\defaultHei{SimHei}                      % 黑体, 用于标题
        \newcommand\defaultKai{KaiTi}                       % 楷体, 一般用于强调
        \newcommand\defaultFag{FangSong}                    % 仿宋, 一般用于强调
    \fi                                                     %
    \ifmacosx                                               % macOS 环境
        \newcommand\defaultSog{STSongti-SC-Regular}         % 宋体, 用于正文
        \newcommand\defaultHei{STHeiti}                     % 黑体, 用于标题
        \newcommand\defaultKai{STKaiti}                     % 楷体, 一般用于强调
        \newcommand\defaultFag{STFangSong}                  % 仿宋, 一般用于强调
    \fi                                                     %
    \iflinux                                                % Linux 环境
        \newcommand\defaultSog{SimSun}                      % 宋体, 用于正文
        \newcommand\defaultHei{SimHei}                      % 黑体, 用于标题
        \newcommand\defaultKai{KaiTi}                       % 楷体, 一般用于强调
        \newcommand\defaultFag{FangSong}                    % 仿宋, 一般用于强调
    \fi                                                     %
\fi                                                         %
\newcommand\defaultEngFont{Times New Roman}                 % 英文文本默认字体
\newcommand\codeFont{Consolas}                              % 等宽英文默认字体
%%-----------------------------------------------------------------------------%
\RequirePackage{fontspec}                                   % 设置字体
\RequirePackage[SlantFont, BoldFont, CJKchecksingle]{xeCJK} % 设置中文字体
\defaultfontfeatures{Mapping=tex-text}                      % 启用 TeX Ligatures
\setCJKmainfont[ItalicFont=\defaultKai, BoldFont=\defaultHei]{\defaultSog}
\setCJKsansfont[ItalicFont=\defaultKai, BoldFont=\defaultHei]{\defaultSog}
\setCJKfamilyfont{song}{\defaultSog}                        % 设置 CJK 字体族
\setCJKfamilyfont{hei}{\defaultHei}                         %
\setCJKfamilyfont{kai}{\defaultKai}                         %
\setCJKfamilyfont{fang}{\defaultFag}                        %
\setCJKfamilyfont{eng}{\defaultEngFont}                     %
\setmonofont{\codeFont}                                     %
\setmainfont{\defaultEngFont}                               %
\newcommand{\fSong}{\CJKfamily{song}}                       % 宋体: fSong
\newcommand{\fHei}{\CJKfamily{hei}}                         % 黑体: fHei
\newcommand{\fKai}{\CJKfamily{kai}}                         % 楷体: fKai
\newcommand{\fFang}{\CJKfamily{fang}}                       % 仿宋: fFang
\newcommand{\fEng}{\CJKfamily{eng}}                         % 英文: fEng
\XeTeXlinebreaklocale "zh"                                  % 使用中文的换行风格
\XeTeXlinebreakskip = 0pt plus 1pt                          % 换行逻辑的弹性大小
%%-----------------------------------------------------------------------------%
\RequirePackage{indentfirst}                                % 段首空格设置
\setlength\parindent{2em}                                   % 段首空格长度
\setlength\parskip{0pt}                                     % 段落间距
\renewcommand{\baselinestretch}{1.0}                        % 行距
%%-----------------------------------------------------------------------------%
\RequirePackage{ulem}                                       % 下划线
\newcommand\dlmu@underline[2][5cm]{\hspace{1pt}\underline{  %
    \hb@xt@ #1{\hss#2\hss}}\hspace{3pt}}                    %
\let\coverunderline\dlmu@underline                          %
%%-----------------------------------------------------------------------------%
\RequirePackage{layouts}                                    % 页面具体尺寸信息
%%-----------------------------------------------------------------------------%
\RequirePackage[sf]{titlesec}                               % 章节标题格式
\RequirePackage{titletoc}                                   % 目录格式
\setcounter{secnumdepth}{3}                                 % 标题计数器深度
\setcounter{tocdepth}{2}                                    % 目录中标题深度
\titleformat{\chapter}[hang]{\fHei\sSanhao\filcenter        %
    }{第\,\thechapter\,章\ \ \ }{0pt}{                      %
    \sSanhao}                                               %
\titleformat{\section}[hang]{\fHei\sSihao}{                 %
    \fHei\sSihao\thesection}{0.5em}{}{}                     %
\titleformat{\subsection}[hang]{\fHei\sHgXiaosi}{           %
    \sHgXiaosi\thesubsection}{0.5em}{}{}                    %
\titleformat{\subsubsection}[hang]{\fHei}{                  % 小标题: (4) 标题
    (\arabic{subsubsection})}{0.5em}{}{}                    %
\titlespacing{\chapter}{0pt}{-16pt}{11pt}                   % 缩小标题之间缩进
\titlespacing{\section}{0pt}{7pt}{0em}                      %
\titlespacing{\subsection}{0pt}{6.5pt}{0em}                 %
\titlespacing{\subsubsection}{0pt}{0.25em}{0pt}             %
\dottedcontents{section}[1.5cm]{}{1.8em}{3pt}               % 定义目录中各级标题
\dottedcontents{subsection}[2.7cm]{}{2.7em}{3pt}            % 之间的格式以及缩进
\dottedcontents{subsubsection}[4.5cm]{}{3.4em}{3pt}         %
\titlecontents{chapter}[0pt]{\fSong\sLgXiaosi\vspace{       %
    0.5em}}{\contentsmargin{0pt}\fSong\makebox[0pt][l]{第\thecontentslabel 章}\hspace{4em}}{\contentsmargin{      %
    0pt}\fSong}{\titlerule*[.25pc]{.}\contentspage}[        %
    \vspace{0em}]                                           %
%%-----------------------------------------------------------------------------%
\RequirePackage{fancyhdr}                                   % 页眉设置
\RequirePackage{fancyref}                                   %
%    \end{macrocode}
% \markdtxchanges{v1.7.0}{2022/10/31}{减少打印裁剪余量}
%    \begin{macrocode}
\addtolength{\topmargin}{0.19cm}                            % 打印裁剪余量

\setlength{\footskip}{1cm}                                  % 脚注位置调整
\newcommand{\npu@headrule}{                                 %
    \rlap{\rule[.7\baselineskip]{\headwidth}{3pt}}          %
    \vspace{-1.07\baselineskip}                             %
    \rule[.5\baselineskip]{\headwidth}{0.6pt}               %
    \vspace{-.8\baselineskip}                               %
}                                                           %
\renewcommand{\headrule}{                                   %
    \if@fancyplain\let\headrulewidth\plainheadrulewidth\fi  %
    \npu@headrule                                           %
}                                                           %
\renewcommand{\chaptermark}[1]{                             % 章节页眉设置
    \markboth{第\thechapter 章~~~  #1}{}}                   %
\pagestyle{fancyplain}                                      % 新增版式 fancyplain
\fancyhf{}                                                  % 清空原有页眉页脚
\fancyfoot[C, C]{\sWuhao{\thepage}}                         % 页脚中央显示页码
\fancyhead{}                                                % 页眉清除原有设置
\fancyhead[COH]{\sXiaowu{\leftmark}}                        %
\if@npu@lang@chs                                            % 中文论文环境
    \fancyhead[CEH]{\sXiaowu{\nwpu@chs@header}}             %
\else                                                       % 英文论文环境
    \fancyhead[CEH]{\sXiaowu{\nwpu@eng@header}}             %
\fi                                                         %
%%-----------------------------------------------------------------------------%
\RequirePackage[numbers, sort&compress]{natbib}             % 参考文献
\let\oldcite\cite                                           % 参考文献
\renewcommand{\cite}[1]{\textsuperscript{\oldcite{#1}}}     % 上标引用形式
%%-----------------------------------------------------------------------------%
\RequirePackage{enumerate}                                  % 编号列表
\RequirePackage{enumitem}                                   % 列表格式控制
\setlist{noitemsep}                                         % 消除列表间距
\setlist{nolistsep}                                         % 消除列表间距
%%-----------------------------------------------------------------------------%
\RequirePackage{graphicx}                                   % 插图功能
\RequirePackage[final]{pdfpages}                            % 插入其他 pdf 文件
\RequirePackage{xcolor}                                     % 颜色库
\RequirePackage{tikz}                                       % tikz 矢量图绘制
\RequirePackage[labelsep=quad]{caption}                     % 浮动体标题控制
\RequirePackage{subcaption}                                 % 子图
\RequirePackage{wrapfig}                                    % 文字环绕
\RequirePackage{multirow, makecell}                         % 合并单元格
\RequirePackage{longtable}                                  % 长表格（跨页表格）
\RequirePackage{booktabs}                                   % 三线表
\RequirePackage{tabularx}                                   % 定宽表格
\RequirePackage{setspace}                                   % 空白长度控制
\RequirePackage{ragged2e}                                   % 对齐
\DeclareCaptionFont{cWuhao}{\sWuhao}                        % 图表标题为五号
\captionsetup[table]{labelfont=cWuhao,textfont=cWuhao}      %
\captionsetup[figure]{labelfont=cWuhao,textfont=cWuhao}     %
%    \end{macrocode}
% \markdtxchanges{v1.7.0}{2022/10/31}{更新子图、子表格式}
%    \begin{macrocode}
\captionsetup[subtable]{labelformat=simple, aboveskip=0pt}  %
\captionsetup[subfigure]{labelformat=simple, aboveskip=0pt} %
\let\oldtabular\tabular                                     % 表格内容为五号
\renewcommand{\tabular}{\sWuhao\oldtabular}                 %
\let\oldtabularx\tabularx                                   %
\renewcommand{\tabularx}{\sWuhao\oldtabularx}               %
\newcolumntype{C}{>{\centering\arraybackslash}X}            % 等宽居中
\newcolumntype{L}{>{\raggedright\arraybackslash}X}          % 等宽左对齐
\newcolumntype{R}{>{\raggedleft\arraybackslash}X}           % 等宽右对齐
%    \end{macrocode}
% \markdtxchanges{v1.7.0}{2022/10/31}{提供指定宽度的左、右、居中对齐表格栏}
%    \begin{macrocode}
\newcolumntype{Q}[1]{>{\raggedleft\let\newline\\%           % 指定宽度右对齐
    \arraybackslash\hspace{0pt}}p{#1}}                      %
\newcolumntype{O}[1]{>{\centering\let\newline\\%            % 指定宽度居中
    \arraybackslash\hspace{0pt}}p{#1}}                      %
\newcolumntype{P}[1]{>{\raggedright\let\newline\\%          % 指定宽度左对齐
    \arraybackslash\hspace{0pt}}p{#1}}                      %
\renewcommand{\arraystretch}{1.4}                           % 表格行高为 1.4 倍
%%-----------------------------------------------------------------------------%
%    \end{macrocode}
% \markdtxchanges{v1.7.0}{2022/10/31}{更新定理环境格式以及证毕符号}
%    \begin{macrocode}
\RequirePackage[thmmarks]{ntheorem}                         % 定理环境格式
\theorembodyfont{\normalfont\itshape}                       % 主体文字格式
\theoremseparator{\quad}                                    % 标题与主体间隔
\setlength\theorempreskipamount{0pt}                        % 节前空白大小
\setlength\theorempostskipamount{0pt}                       % 节后空白大小
{\theoremsymbol{\ensuremath{\square}}                       % 证明环境 囗
\if@npu@lang@chs\newtheorem*{proof}{证明}\else\newtheorem*{proof}{Proof}\fi}
\newcommand{\qedinEquation}{{\rlap{$\qquad\square$}}}       % 公式中添加证毕符号
\if@npu@lang@chs                                            % 定制中文定理环境
    \newtheorem{theorem}{定理}[chapter]                     %
    \newtheorem{axiom}[theorem]{公理}                       %
    \newtheorem{corollary}[theorem]{推论}                   %
    \newtheorem{lemma}[theorem]{引理}                       %
    \newtheorem{definition}[theorem]{定义}                  %
    \newtheorem{example}[theorem]{例}                       %
    \newtheorem{proposition}[theorem]{命题}                 %
\else                                                       % 定制英文定理环境
    \newtheorem{theorem}{Theorem}[chapter]                  %
    \newtheorem{axiom}[theorem]{Axiom}                      %
    \newtheorem{corollary}[theorem]{Corollary}              %
    \newtheorem{lemma}[theorem]{Lemma}                      %
    \newtheorem{definition}[theorem]{Definition}            %
    \newtheorem{example}[theorem]{Example}                  %
    \newtheorem{proposition}[theorem]{Proposition}          %
\fi                                                         %
%%-----------------------------------------------------------------------------%
\RequirePackage{listings}                                   % 添加插入代码控制
\lstset{                                                    % 代码样式
    basicstyle=\color[HTML]{000000}\small\ttfamily,         % 等宽字体 10pt 字号
    numbers=left,                                           % 左侧加入行号
    numberstyle=\tiny,                                      % 行号 6pt 字号
    numbersep=5pt,                                          % 行号与代码间隔
    tabsize=4,                                              % 制表符大小
    extendedchars=true,                                     % 拓展字符集显示汉字
    breaklines=true,                                        % 允许自动换行
    keywordstyle=\color[HTML]{0000FF}\bfseries,             % 关键字样式
    numberstyle=\color[HTML]{ff8000},                       % 数字样式
    commentstyle=\color[HTML]{008000}\bfseries,             % 注释样式
    stringstyle=\color[HTML]{A31515}\ttfamily,              % 字符串样式
    showspaces=false,                                       % 不显示空格字符
    showtabs=false,                                         % 不显示制表符
    frame=shadowbox,                                        % 添加阴影边框
    framexrightmargin=5pt,                                  % 边框右边缩进
    framexbottommargin=4pt,                                 % 边框底端缩进
    rulesepcolor=\color[HTML]{C0C0C0},                      % 边框颜色
    showstringspaces=false,                                 % 显示字符串内空格
    escapeinside=`',                                        % 逃逸字符以显示公式
}                                                           %
\lstloadlanguages{C, C++, Java, Python, Matlab, R, Mathematica}% 默认加载常用语言
%%-----------------------------------------------------------------------------%
\RequirePackage{algorithm}                                  % 算法流程
\RequirePackage{algpseudocode}                              % 伪代码
%%-----------------------------------------------------------------------------%
\RequirePackage{appendix}                                   % 添加附录功能
%%-----------------------------------------------------------------------------%
%    \end{macrocode}
% \markdtxchanges{v1.7.0}{2022/10/31}{使用单栏符号表}
%    \begin{macrocode}
\RequirePackage{nomencl}                                    % 添加符号表功能
\RequirePackage{multicol}                                   % 页面具体尺寸信息
\makenomenclature                                           % 单栏符号表
% https://tex.stackexchange.com/questions/78764/two-column-nomenclature
\@ifundefined{chapter}{\def\npu@nomsec{section}}{\def\npu@nomsec{chapter}}
\def\thenomenclature{%
    % \newlength{\npu@columnsep@save}
    % \setlength{\npu@columnsep@save}{\columnsep}
    % \setlength{\columnsep}{20pt}
    % \begin{multicols}{2}[%
        \csname\npu@nomsec\endcsname*{\nomname}
        \if@intoc\addcontentsline{toc}{\npu@nomsec}{\nomname}\fi
        \nompreamble % \raggedcolumns
    % ]
    \list{}{\labelsep=15pt\labelwidth\nom@tempdim\leftmargin\labelwidth\advance
        \leftmargin\labelsep\itemsep\nomitemsep\let\makelabel\nomlabel}%
}
\def\endthenomenclature{\endlist
    % \end{multicols}
    % \setlength{\columnsep}{\npu@columnsep@save}
    \nompostamble}
%%=============================================================================%
%    \end{macrocode}
%
%^^A---------------------------------------------------------------------------%
% \subsection{引用设置及本地化处理}
%
% \begin{itemize}
%     \item 修改引用提示文字．
%     \item 修改引用编号格式．
%     \item 本地化文档字符串处理．
% \end{itemize}
%
%    \begin{macrocode}
%%=============================================================================%
%% 引用设置及本地化处理
%%-----------------------------------------------------------------------------%
\if@npu@lang@chs                                            % 中文引用提示文字
    \renewcommand{\figurename}{图}                          %
    \renewcommand{\tablename}{表}                           %
    \renewcommand{\bibname}{参考文献}                       %
    \renewcommand{\contentsname}{目{\quad}录}               %
    \renewcommand{\listfigurename}{图目录}                  %
    \renewcommand{\listtablename}{表目录}                   %
    \renewcommand{\figureautorefname}{图}                   %
    \renewcommand{\tableautorefname}{表}                    %
    \renewcommand{\appendixautorefname}{附录}               %
    \def\equationautorefname#1#2\null{式#1(#2\null)}        %
    \renewcommand{\theoremautorefname}{定理}                %
    \newcommand{\axiomautorefname}{公理}                    %
    \newcommand{\corollaryautorefname}{推论}                %
    \newcommand{\lemmaautorefname}{引理}                    %
    \newcommand{\definitionautorefname}{定义}               %
    \newcommand{\exampleautorefname}{例}                    %
    \newcommand{\propositionautorefname}{命题}              %
%    \end{macrocode}
% \markdtxchanges{v1.7.0}{2022/10/31}{补充算法的中文引用提示文字}
%    \begin{macrocode}
    \newcommand{\algorithmname}{算法}                       %
    \newcommand{\algorithmautorefname}{算法}                %
    \renewcommand{\lstlistingname}{代码片段}                %
    \newcommand{\lstlistingautorefname}{代码片段}           %
    \renewcommand{\nomname}{符号表}                         %
\else                                                       % 英文引用提示文字
    \renewcommand{\figureautorefname}{Fig.}                 %
    \renewcommand{\tableautorefname}{Table}                 %
    \renewcommand{\appendixautorefname}{Appendix}           %
    \def\equationautorefname#1#2\null{Eq.#1(#2\null)}       %
    \renewcommand{\lstlistingname}{Code Snippet}            %
    \newcommand{\lstlistingautorefname}{Code Snippet}       %
    \renewcommand{\nomname}{Symbols}                        %
\fi                                                         %
%%-----------------------------------------------------------------------------%
\renewcommand{\chaptername}{\thechapter~~}                  % 章节名
\renewcommand{\thefigure}{\thechapter-\arabic{figure}}      % 图编号格式
\renewcommand{\thesubfigure}{(\alph{subfigure})}            % 子图编号格式
\renewcommand{\thetable}{\thechapter-\arabic{table}}        % 图编号格式
%    \end{macrocode}
% \markdtxchanges{v1.7.0}{2022/10/31}{增加算法编号}
%    \begin{macrocode}
\renewcommand{\thealgorithm}{\thechapter.\arabic{algorithm}}% 算法编号格式
\renewcommand{\theequation}{\thechapter-\arabic{equation}}  % 公式编号格式
\renewcommand{\thetheorem}{\thechapter.\arabic{theorem}}    % 定理编号格式
\renewcommand{\theaxiom}{\thechapter.\arabic{axiom}}        % 公理编号格式
\renewcommand{\thecorollary}{\thechapter.\arabic{corollary}}% 推论编号格式
\renewcommand{\thelemma}{\thechapter.\arabic{lemma}}        % 引理编号格式
\renewcommand{\thedefinition}{\thechapter.\arabic{definition}} % 定义编号格式
\renewcommand{\theexample}{\thechapter.\arabic{example}}    % 例子编号格式
%%-----------------------------------------------------------------------------%
\newcommand{\nwpu@chs@schoolname}{西北工业大学}             % 文档字符串设置
\newcommand{\nwpu@eng@schoolname}{Northwestern Polytechnical University}
\if@npu@type@phd                                            % 博士学位名
    \newcommand{\nwpu@chs@degree}{博士}                     %
    \newcommand{\nwpu@eng@degree}{Doctor}                   %
\fi                                                         %
\if@npu@type@mst                                            % 硕士学位名
    \newcommand{\nwpu@chs@degree}{硕士}                     %
    \newcommand{\nwpu@eng@degree}{Master}                   %
\fi                                                         %
\if@npu@type@bcl                                            % 学士学位名
    \newcommand{\nwpu@chs@degree}{学士}                     %
    \newcommand{\nwpu@eng@degree}{Bachelor}                 %
\fi                                                         %
\if@npu@type@bcl                                            % 本科特殊设置
    \newcommand{\nwpu@chs@doctitle}{本科毕业设计论文}       % 文档名和页眉
    \newcommand{\nwpu@chs@header}{{\nwpu@chs@schoolname}本科毕业设计论文}
\else                                                       % 其他页眉统一设置
    \newcommand{\nwpu@chs@doctitle}{{\nwpu@chs@degree}学位论文}
    \newcommand{\nwpu@chs@header}{\nwpu@chs@schoolname\nwpu@chs@doctitle}
\fi                                                         %
\newcommand{\nwpu@eng@doctitle}{\nwpu@eng@degree Thesis}    % 英文文档名和页眉
\newcommand{\nwpu@eng@header}{\nwpu@eng@doctitle of \nwpu@eng@schoolname}
%%-----------------------------------------------------------------------------%
\if@npu@lang@chs                                            % 定制中文特殊页面
    \newcommand{\nwpu@page@ack}{致{\quad}谢}                %
    \newcommand{\nwpu@page@acp}{在学期间发表的学术成果和参加科研情况}                     %
\else                                                       % 定制英文特殊页面
    \newcommand{\nwpu@page@ack}{Acknowledgements}           %
    \newcommand{\nwpu@page@acp}{Published Papers and        %
        Participated in Scientific Research During the Study%
        for \nwpu@eng@degree Degree}                        %
\fi                                                         %
%%=============================================================================%
%    \end{macrocode}
%
% \subsection{中文占位符及个人信息填写}
%
% \begin{itemize}
%     \item 人工录入中文标点符号．
%     \item 添加中英文个人信息录入，包括：
%     \begin{itemize}
%         \item 标题 |\title{中文}{English}|；
%         \item 作者 |\author{中文}{English}|；
%         \item 日期 |\date{中文}{English}|；
%         \item 学院 |\school{中文}{English}|；
%         \item 专业 |\major{中文}{English}|；
%         \item 导师 |\advisor{中文}{English}|；
%         \item 学号 |\studentnumber{数字}|；
%         \item 基金资助详情 |\funding{中文}{English}|．
%     \end{itemize}
% \end{itemize}
%
%    \begin{macrocode}
%%=============================================================================%
%% 中文占位符及个人信息填写
%%-----------------------------------------------------------------------------%
\newcommand{\chs@colon}{\char"FF1A}                         % 中文冒号
\newcommand{\chs@space}{\char"3000}                         % 全角空格
\newcommand{\chs@period}{\char"3002}                        % 中文句号
\newcommand{\chs@question}{\char"FF1F}                      % 中文问号
\newcommand{\chs@exclamation}{\char"FF01}                   % 中文感叹号
\newcommand{\chs@comma}{\char"FF0C}                         % 中文逗号
\newcommand{\chs@semicolon}{\char"FF1B}                     % 中文分号
\newcommand{\chs@leftparenthesis}{\char"FF08}               % 左括号
\newcommand{\chs@rightparenthesis}{\char"FF09}              % 右括号
%%-----------------------------------------------------------------------------%
\newcommand{\nwpu@chs@title}{\chs@space}                    % 标题（中文）
\newcommand{\nwpu@chs@author}{\chs@space}                   % 作者（中文）
\newcommand{\nwpu@chs@date}{\chs@space}                     % 日期（中文）
\newcommand{\nwpu@chs@school}{\chs@space}                   % 学院（中文）
\newcommand{\nwpu@chs@major}{\chs@space}                    % 专业（中文）
\newcommand{\nwpu@chs@advisor}{\chs@space}                  % 导师（中文）
\newcommand{\nwpu@chs@advisoralign}{\chs@space}             % 导师对齐（中文）
\newcommand{\nwpu@chs@funding}{\chs@space}                  % 基金赞助（中文）
%%-----------------------------------------------------------------------------%
\newcommand{\nwpu@eng@title}{\chs@space}                    % 标题（英文）
\newcommand{\nwpu@eng@author}{\chs@space}                   % 作者（英文）
\newcommand{\nwpu@eng@date}{\chs@space}                     % 日期（英文）
\newcommand{\nwpu@eng@school}{\chs@space}                   % 学院（英文）
\newcommand{\nwpu@eng@major}{\chs@space}                    % 专业（英文）
\newcommand{\nwpu@eng@advisor}{\chs@space}                  % 导师（英文）
\newcommand{\nwpu@eng@advisoralign}{\chs@space}             % 导师对齐（英文）
\newcommand{\nwpu@eng@funding}{\chs@space}                  % 基金赞助（英文）
%%-----------------------------------------------------------------------------%
\newcommand{\nwpu@uid}{2000123456}                          % default 学号
\newcommand{\nwpu@funding}{\chs@space}                      % 基金资助
%%-----------------------------------------------------------------------------%
\renewcommand{\title}[2]{                                   % 设置题目
    \renewcommand{\nwpu@chs@title}{#1}                      %
    \renewcommand{\nwpu@eng@title}{#2}                      %
}                                                           %
\renewcommand{\author}[2]{                                  % 设置作者
    \renewcommand{\nwpu@chs@author}{#1}                     %
    \renewcommand{\nwpu@eng@author}{#2}                     %
}                                                           %
\renewcommand{\date}[2]{                                    % 设置日期
    \renewcommand{\nwpu@chs@date}{#1}                       %
    \renewcommand{\nwpu@eng@date}{#2}                       %
}                                                           %
\newcommand{\school}[2]{                                    % 设置学院
    \renewcommand{\nwpu@chs@school}{#1}                     %
    \renewcommand{\nwpu@eng@school}{#2}                     %
}                                                           %
\newcommand{\major}[2]{                                     % 设置专业
    \renewcommand{\nwpu@chs@major}{#1}                      %
    \renewcommand{\nwpu@eng@major}{#2}                      %
}                                                           %
\newcommand{\advisor}[2]{                                   % 设置导师
    \renewcommand{\nwpu@chs@advisor}{#1}                    %
    \renewcommand{\nwpu@eng@advisor}{#2}                    %
}
\newcommand{\advisoralign}[2]{                              % 设置导师对齐
    \renewcommand{\nwpu@chs@advisoralign}{#1}               %
    \renewcommand{\nwpu@eng@advisoralign}{#2}               %
}                                                           %
\newcommand{\funding}[2]{                                   % 设置基金资助
    \renewcommand{\nwpu@chs@funding}{#1}                    %
    \renewcommand{\nwpu@eng@funding}{#2}                    %
}                                                           %
\newcommand{\studentnumber}[1]{\renewcommand{\nwpu@uid}{#1}}% 设置学号
%%=============================================================================%
%    \end{macrocode}
%
% \subsection{封皮页及中英文标题页}
%
% \begin{itemize}
%     \item 输入 |\maketitle| 为文档添加封皮页、中英文标题页．
%     \item 命令 |\make@nwpu@coverpage| 为封皮页的具体实现．
%     \item 命令 |\make@nwpu@chs@title| 为中文标题页的具体实现．
%     \item 命令 |\make@nwpu@eng@title| 为英文标题页的具体实现．
%     \item 所有信息使用上一小节所设置的信息．
%     \item 标题如果需要分行可在 |\title| 中自行插入 |\\| 断句．
% \end{itemize}
%
%    \begin{macrocode}
%%=============================================================================%
%% 封皮页
%%-----------------------------------------------------------------------------%
\newcommand{\make@nwpu@coverpage}{                          % 设置封皮页
\thispagestyle{empty}                                       % 清空页面格式
\newlength{\coverpage@infowidth}                            % 基本信息表格宽度
\settowidth{\coverpage@infowidth}{\fHei\sWuhao 学校代码~:~ 200000000000000000}
\newlength{\coverpage@detailwidth}                          % 具体信息对齐宽度
\settowidth{\coverpage@detailwidth}{\sSanhao 申请学位日期}  %
\begin{titlepage}                                           %
    \bfseries                                               %
    \linespread{1.25}                                       % 1.25 倍行距
    \begin{center}                                          %
        \hfill \fHei \sWuhao                                %
        \begin{minipage}{\coverpage@infowidth}              % 排版基本信息表
    \begin{center}                                          %
        \hfill \fHei \sWuhao                                %
        \begin{minipage}{\coverpage@infowidth}              % 排版基本信息表
            \vspace{-.3cm}                                  %
            \renewcommand\arraystretch{1.2}                 %
            \linespread{1.4}                                %
            \begin{tabular}{|c|c|}\hline                    %
                {学 \hfill 校 \hfill 代 \hfill 码} & 10699     \\ \hline
                {分   \hfill    类    \hfill   号} & TP316.9   \\ \hline
                {密           \hfill           级} & 公开      \\ \hline
                {学           \hfill           号} & \ \ \nwpu@uid \ \  \\ \hline
             \end{tabular}                                  %
        \end{minipage} \par                                 % 排版结束
        \vspace{9.3cm} \fHei \sErhao                        %
        \begin{minipage}[t]{2.3cm}                          % 排版标题
            \hfill \  {\bfseries \sErhao 题目} \\           %
        \end{minipage}                                      %
        \setbox123=\hbox{                                   %
            \begin{minipage}[t]{12.2cm}                     %
                \begin{center}                              %
                    \begin{spacing}{1.6}                    %
                        \fHei \sErhao                       %
                        \nwpu@chs@title                     %
                    \end{spacing}                           %
                \end{center}                                %
            \end{minipage}                                  %
        }                                                   %
        \setbox124=\hbox{                                   %
            \begin{minipage}[t]{12.2cm}                     %
                \begin{center}                              %
                    \begin{spacing}{1.6}                    %
                        \fHei \sErhao                       %
                        \uline{\hfill\quad\hfill} \\        %
                        \uline{\hfill\quad\hfill} \\        %
                    \end{spacing}                           %
                    % \uline{\hfill\quad\hfill} \\          %
                    % \vspace{+.32cm}                       %
                    % \uline{\hfill\quad\hfill} \\          %
                \end{center}                                %
            \end{minipage}                                  %
        }                                                   %
        \hspace{-0.5cm}                                     %
        \copy123\kern-\wd123\box124 \fSong \sSanhao \par    % 排版结束
        \vspace{0.15cm}                                     % => 3 * 24pt * 1.25
        \begin{minipage}{5cm}                               % 排版具体信息
            {作者} \uline{\hfill \nwpu@chs@author \hfill}   %
        \end{minipage} \par                                 %
        \vspace{1.5\baselineskip}                           % => 2.5 * 24pt * 1.25
        \begin{minipage}{12.5cm}                            %
            \noindent                                       %
            \makebox[\coverpage@detailwidth][s]{学\ 科\ 专\ 业}
            {\uline{\hfill \makebox{\fSong \nwpu@chs@major } \hfill}} \par
            % \vspace{0.5\baselineskip}                       % => 0.5 * 24pt * 1.25
            \makebox[\coverpage@detailwidth][s]{指\ 导\ 教\ 师}
            {\uline{\hfill \makebox{\fSong \nwpu@chs@advisor \ 教授 } \hfill}} \par
            % \vspace{0.5\baselineskip}               
            \makebox[\coverpage@detailwidth][s]{培\ 养\ 单\ 位}
            {\uline{\hfill \makebox{\fSong \nwpu@chs@school } \hfill}} \par
            % \vspace{0.5\baselineskip}               
            \makebox[\coverpage@detailwidth][s]{申\ 请\ 日\ 期}
            {\uline{\hfill \makebox{\fSong \nwpu@chs@date } \hfill}} \par
            % \vspace{0.5\baselineskip}                       % => 0.5 * 24pt * 1.25
            % \makebox[\coverpage@detailwidth][s]{申请日期}\hspace{0.2cm}
            % {\uline{\hfill \makebox{\fSong \nwpu@chs@date } \hfill}}
        \end{minipage}                                      % 排版结束
        \vspace{2.5\baselineskip}                           % => 2.5 * 24pt * 1.25
    \end{center}                                            %
\end{titlepage} \fSong \normalsize \newpage \clearpage      %
}                                                           %
%%-----------------------------------------------------------------------------%
%% 中文标题页
%%-----------------------------------------------------------------------------%
\newcommand{\make@nwpu@chs@title}{                          % 设置中文标题页
\thispagestyle{empty}                                       % 清空页面格式
\newlength{\chstitle@hwidtha}                               % 大标题宽度
\settowidth{\chstitle@hwidtha}{\sSanhao\nwpu@chs@schoolname}%
\newlength{\chstitle@hwidthb}                               % 小标题宽度
\settowidth{\chstitle@hwidthb}{\sYihao\nwpu@chs@doctitle}   %
\begin{titlepage}                                           %
    \linespread{1.5} \fSong \sSanhao \par                   % 1.5 倍行距
    % \vspace{1\baselineskip}                                 % => 1 * 21pt * 1.5
    \begin{center}      
        \ \\

        \vspace{1.5cm}   
        \hspace{0.18cm}               %
        \makebox[1.54\chstitle@hwidtha][s]{
            \sSanhao\nwpu@chs@schoolname } \par
        % \vspace*{5mm}                                       %
        \vspace{0.2cm}
        \hspace{0.45cm}
        \makebox[1.41667\chstitle@hwidthb][s]{\sYihao\nwpu@chs@doctitle} \par

        % \vspace*{5mm}                                       %
        % \sSihao （学位研究生）\par                          %
        \vspace{5.95cm}                             % => 6 * 21pt * 1.5
        \fSong \sErhao                                      % 排版标题
        \hspace{-1.5cm} 
        \begin{minipage}[t]{2cm} \hfill {题目：} \\ \end{minipage}
        \setbox123=\hbox{                                   %
            \begin{minipage}[t]{7.75cm}                       %
                \begin{center} \nwpu@chs@title \end{center} %
            \end{minipage}                                  %
        }                  
        \hspace{+0.5cm}                                 %
        \setbox124=\hbox{                                   %
            \begin{minipage}[t]{7.75cm}                       %
                \begin{center}                              %
                    \uline{\hfill\quad\hfill} \\            %
                    \uline{\hfill\quad\hfill} \\            %
                \end{center}                                %
            \end{minipage}                                  %
        }                                                   %
        \hspace{-1cm}                                       %
        \copy123\kern-\wd123\box124 \fSong \sWuhao \par     % 排版结束
        \vspace{3cm}                             % => 7 * 10.5pt * 1.5
        % \linespread{1.5}
        \hspace{-2.5cm}
        \sSanhao 学科专业：\coverunderline[4cm]{\nwpu@chs@major} \\
        \hspace{-2.5cm}
        \sSanhao 作{\qquad}者：\coverunderline[4cm]{\nwpu@chs@author} \\
        % \sSanhao 学科专业：\coverunderline[5.5cm]{\nwpu@chs@major} \\
        \hspace{-2.5cm}
        \sSanhao 指导教师：\coverunderline[4cm]{\nwpu@chs@advisoralign} \\
        \fSong \sWuhao \par                                 %
        \vspace{2\baselineskip}                             % => 2 * 10.5pt * 1.5
        \hspace{-0.5cm}
        \fSong \sSanhao \nwpu@chs@date                      %
    \end{center}                                            %
\end{titlepage} \fSong \normalsize \newpage \clearpage      %
}                                                           %
%%-----------------------------------------------------------------------------%
%% 英文标题页
%%-----------------------------------------------------------------------------%
\newcommand{\make@nwpu@eng@title}{                          % 设置英文标题页
\thispagestyle{empty}                                       % 清空页面格式
\begin{titlepage}                                           %
    \linespread{1.2} \fEng \sXiaosan \par                   % 1.2 倍行距
    \vspace{1\baselineskip}                                 % => 1 * 22pt * 1.2
    \begin{center}                                          %
        \fEng \sErhao
        \ \\
        \ \\
        \ \\
                                                  %
        \fEng \sErhao \textbf{Title:} \fEng \sSanhao \nwpu@eng@title \par         %
        \fSong \sXiaoer 
        \ \\
        \ \\

        \fEng \sXiaosan \textbf{By} \par                    %
        \vspace{-0.1cm}
        \fEng \sXiaosan \nwpu@eng@author\par      %
        \vspace{-0.2cm}
        \fEng \sXiaosan \textbf{Under the Supervision of Professor} \\
        \vspace{-0.1cm}
        \fEng \sXiaosan \nwpu@eng@advisor \par     %
        \fSong \sSanhao \vspace{3.5cm}             %
        \fEng \sXiaosan A Dissertation Submitted to \\      %
        \vspace{-0.2cm}
        \fEng \sXiaosan {\nwpu@eng@schoolname} \\%
        \fSong \sSanhao \vspace{0.5cm}
        \fEng In partial fulfillment of the requirement \\  %
        \vspace{-0.3cm}
        \fEng For the degree of \\                          %
        \vspace{-0.3cm}
        \fEng {\nwpu@eng@degree} of \textbf{\nwpu@eng@major}%
        \fSong \sXiaosan \par \vspace{3\baselineskip}       %
        \fEng \sXiaosan Xi'an, P.R. China \\                %
        \fEng \sXiaosan {\nwpu@eng@date}                    %
    \end{center}                                            %
\end{titlepage} \fSong \normalsize \newpage                 %
\thispagestyle{empty} \cleardoublepage                      %
}                                                           %
%%-----------------------------------------------------------------------------%
%% 生成标题页
%%-----------------------------------------------------------------------------%
\renewcommand{\maketitle}{                                  % 重制 maketitle
    \make@nwpu@coverpage                                    % 封皮页
    \make@nwpu@chs@title                                    % 中文标题页
    \make@nwpu@eng@title                                    % 英文标题页
    \pagenumbering{Roman}                                   % 页码使用大写罗马字母
    \setcounter{page}{1}                                    % 页码从 1 开始
    \renewcommand{\baselinestretch}{1.0}                    % 默认单倍行距
}                                                           %
%%=============================================================================%
%    \end{macrocode}
%
% \subsection{中英文摘要环境}
%
% \begin{itemize}
%     \item 在 |abstract| 环境内填写文章中文摘要．
%     \item 在 |keywords| 环境内填写文章中文关键词．
%     \item 在 |engabstract| 环境内填写文章英文摘要．
%     \item 在 |engkeywords| 环境内填写文章英文关键词．
% \end{itemize}
%
%    \begin{macrocode}
%%=============================================================================%
%% 中文摘要及关键词
%%-----------------------------------------------------------------------------%
\newenvironment{abstract}{                                  %
    \sDefault                                               %
    \chapter[摘{\quad}要]{\vspace{+13pt}摘{\quad}要}         %
    \markboth{摘{\quad}要}{摘{\quad}要}                      %
}{\vfill\sWuhao \noindent \nwpu@chs@funding \par \cleardoublepage}
\newenvironment{keywords}{                                  %
    \vspace{2\baselineskip} \par                            %
    \fHei 关键词：\fSong}{}                                  %
%%-----------------------------------------------------------------------------%
%% 英文摘要及关键词
%%-----------------------------------------------------------------------------%
\newenvironment{engabstract}{                               %
    \sDefault                                               %
    \chapter[ABSTRACT]{\vspace{+13pt}\textbf{Abstract}}     %
    \markboth{Abstract}{ABSTRACT}                           %
}{\vfill\sWuhao \noindent \nwpu@eng@funding \par \cleardoublepage}        %
\newenvironment{engkeywords}{                               %
    \vspace{2\baselineskip} \par                            %
    \noindent \textbf{Key Words:}\quad}{}                   %
%%=============================================================================%
%    \end{macrocode}
%
% \subsection{目录页}
%
% \begin{itemize}
%     \item 使用 |\tableofcontents| 添加总目录．
%     \item 使用 |\listoffigures| 添加图目录（学校未做要求）．
%     \item 使用 |\listoftables| 添加表目录（学校未做要求）．
%     \item 使用 |\printnomenclature| 添加符号表（学校未做要求）．
% \end{itemize}
%
%    \begin{macrocode}
%%=============================================================================%
%% 目录页
%%-----------------------------------------------------------------------------%
\let\old@toc\tableofcontents                                % 目录
\renewcommand{\tableofcontents}{                            %
\sDefault
% \chapter[\contentsname]{\vspace{+13pt} \contentsname}    
% \markboth{\contentsname}{\contentsname}  
\phantomsection                                %
% \addcontentsline{toc}{chapter}{\contentsname}           %
% 设置目录标题
\titlespacing{\chapter}{0pt}{-3pt}{11pt}{
    \old@toc
}

\cleardoublepage                               %
}                                                           %
\let\old@lof\listoffigures                                  % 图目录
\renewcommand{\listoffigures}{                              %
    \sDefault\phantomsection                                %
    % \addcontentsline{toc}{chapter}{\listfigurename}         %
    \old@lof \cleardoublepage                               %
}                                                           %
\let\old@log\listoftables                                   % 表目录
\renewcommand{\listoftables}{                               %
    \sDefault\phantomsection                                %
    % \addcontentsline{toc}{chapter}{\listtablename}          %
    \old@log \cleardoublepage                               %
}                                                           %
%%=============================================================================%
%    \end{macrocode}
%
% \subsection{参考文献及附录处理}
%
% \begin{itemize}
%     \item 通过命令 |\bibliographystyle{filename}| 设置参考文献格式．
%     \item 通过命令 |\bibliography{filename}| 加入对应文件名的 bibtex 文献．
%     \item 附录要求使用大写英文字母表示章节编号，引用时使用小写英文字母．
%     \item 定制目录及正文中章节名的格式．
% \end{itemize}
%
%    \begin{macrocode}
%%=============================================================================%
%% 参考文献及附录处理
%%-----------------------------------------------------------------------------%
%    \end{macrocode}
% \markdtxchanges{v1.7.0}{2022/10/31}{减少参考文件条目间间隔}
%    \begin{macrocode}
\let\old@bibliography\bibliography                          % 保护原有附录环境
\renewcommand{\bibliography}[1]{                            %
    \phantomsection \addcontentsline{toc}{chapter}{参考文献}%
    \renewcommand{\baselinestretch}{1.0}                    %
    \fontsize{12pt}{13pt}\selectfont                        %
    \setlength{\bibsep}{0.5ex}                              %
%    \end{macrocode}
% \markdtxchanges{v1.7.1}{2022/11/01}{取消默认参考文献格式设置}
%    \begin{macrocode}
    \sDefault 
    \titlespacing{\chapter}{0pt}{-18pt}{11pt}{
    \old@bibliography{#1} 
    }
    \cleardoublepage        % 参考文献 bib 文件
}                                                           %
%%-----------------------------------------------------------------------------%
\let\old@appendix\appendix                                  % 保护原有附录环境
\renewcommand{\appendix}{                                   % 在原有基础上定制
    \old@appendix                                           %
    \setcounter{chapter}{0}                                 % 重置章节编号
    \if@npu@lang@chs                                        % 中文本地化显示
        \renewcommand{\thechapter}{附录\Alph{chapter}}      %
        \renewcommand{\appendixname}{附录}                  %
    \else                                                   % 英文使用默认环境
        \renewcommand{\thechapter}{Appendix \Alph{chapter}} %
        \renewcommand{\appendixname}{Appendix}              %
    \fi                                                     %
    \titleformat{\chapter}[hang]{\normalfont\sSanhao        %
        \filcenter\fHei\bf}{\fHei\sSanhao{\thechapter}}{    %
        20pt}{\sSanhao}                                     %
    \titlecontents{chapter}[0pt]{\fSong\sLgXiaosi\vspace{   %
        0.5em}}{\contentsmargin{0pt}\fSong\makebox[0pt][l]{ %
        \thecontentslabel}\hspace{4em}}{\contentsmargin{    %
        0pt}\fSong}{\titlerule*[.25pc]{.}\contentspage}[     %
        \vspace{0em}]                                       %
    \renewcommand{\thesection}{\Alph{chapter}.\arabic{section}}
    \renewcommand{\theequation}{\alph{chapter}-\arabic{equation}}
    \renewcommand{\thetable}{\alph{chapter}-\arabic{table}}
    \renewcommand{\thefigure}{\alph{chapter}-\arabic{figure}}
    \renewcommand{\thetheorem}{\alph{chapter}.\arabic{theorem}}
    \renewcommand{\theaxiom}{\alph{chapter}.\arabic{axiom}}
    \renewcommand{\thecorollary}{\alph{chapter}.\arabic{corollary}}
    \renewcommand{\thelemma}{\alph{chapter}.\arabic{lemma}}
    \renewcommand{\thedefinition}{\alph{chapter}.\arabic{definition}}
    \renewcommand{\theexample}{\alph{chapter}.\arabic{example}}
}                                                           %
%%=============================================================================%
%    \end{macrocode}
%
% \subsection{附页部分}
%
% \begin{itemize}
%     \item 在 |acknowledgements| 环境内填写致谢．
%     \item 在 |accomplishments| 环境内填写参加科研情况．
%     \item 使用 |\makestatement| 添加知识产权与原创性声明．
% \end{itemize}
%
%    \begin{macrocode}
%%=============================================================================%
%% 附页部分
%%-----------------------------------------------------------------------------%
\newenvironment{acknowledgements}{                          % 致谢
    \renewcommand{\baselinestretch}{1.5}                    %
    \titlespacing{\chapter}{0pt}{-30pt}{11pt}{
    \fontsize{12pt}{13pt}\selectfont                        %
    \phantomsection\chapter*{\nwpu@page@ack}                %
    \markboth{\nwpu@page@ack}{\nwpu@page@ack}               %
    \addcontentsline{toc}{chapter}{\nwpu@page@ack}          %
    }
}{\par \cleardoublepage}                                    %
%%-----------------------------------------------------------------------------%
\newenvironment{accomplishments}{                           % 参加科研情况
    \renewcommand{\baselinestretch}{1.5}                    %
    \titlespacing{\chapter}{0pt}{-20pt}{11pt}{
    \fontsize{12pt}{13pt}\selectfont                        %
    \phantomsection\chapter*{\nwpu@page@acp}                %
    \markboth{\nwpu@page@acp}{}                             %
    \addcontentsline{toc}{chapter}{\nwpu@page@acp}          %
    \newlength{\oldparindent}                               %
    \setlength{\oldparindent}{\parindent}                   %
    \setlength{\parindent}{0pt}                             %
    }
}{\setlength{\parindent}{\oldparindent} \cleardoublepage}   %
%%-----------------------------------------------------------------------------%
\newcommand{\makestatement}{                                % 知识产权与原创性声明
\begin{titlepage}
    \linespread{1.5}
    \parskip=7pt
    \vspace*{0pt}
    \fSong\sSihao
    \centerline{\bf 西北工业大学}
    \centerline{\bf 学位论文知识产权声明书}
    \fSong\sWuhao
    本人完全了解学校有关保护知识产权的规定，即：研究生在校攻读学位期间论文工作的
    知识产权单位属于西北工业大学。学校有权保留并向国家有关部门或机构送交论文的复
    印件和电子版。本人允许论文被查阅和借阅。学校可以将本学位论文的全部或部分内容
    编入有关数据库进行检索，可以采用影印、缩印或扫描等复制手段保存和汇编本学位论
    文。同时本人保证，毕业后结合学位论文研究课题再撰写的文章一律注明作者单位为西
    北工业大学。\par
    保密论文待解密后适用本声明。\par
    学位论文作者签名{~:~}\underline{\qquad\qquad\qquad} \hfill
    指导教师签名{~:~}\underline{\qquad\qquad\qquad} \par
    \hspace*{3cm} {年\qquad 月\qquad 日} \hfill\hspace*{3cm} {年\qquad 月\qquad 日}
    \vspace*{30pt} \par
    \hbox to \hsize{\leaders\hbox to 1em{\hss--\hss}\hfill} \par
    \vspace*{50pt}
    \fSong\sSihao
    \centerline{\bf 西北工业大学}
    \centerline{\bf 学位论文原创性声明}
    \fSong\sWuhao
    秉承学校严谨的学风和优良的科学道德，本人郑重声明：所呈交的学位论文，是本人在
    导师的指导下进行研究工作所取得的成果。尽我所知，除文中已经注明引用的内容和致
    谢的地方外，本论文不包含任何其他个人或集体已经公开发表或撰写过的研究成果，不
    包含本人或其他已申请学位或其他用途使用过的成果。对本文的研究做出重要贡献的个
    人和集体，均已在文中以明确方式表明。\par
    本人学位论文与资料若有不实，愿意承担一切相关的法律责任。\par
    \hspace*{5.5cm}
    \hfill 学位论文作者签名{~:~}\underline{\qquad\qquad\qquad}\par
    \hfill\hspace*{8.5cm} {年\qquad 月\qquad 日}
\end{titlepage}
}                                                           %
%%=============================================================================%
%</class>
%    \end{macrocode}

% \Finale
\endinput
